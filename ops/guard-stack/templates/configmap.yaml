apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "guard-stack.configMapName" . }}
  labels:
    {{- include "guard-stack.labels" . | nindent 4 }}
data:
  # Application settings
  APP_ENV: {{ .Values.config.appEnv | quote }}
  PUBLIC_BASE_URL: {{ .Values.config.publicBaseUrl | quote }}
  FORCE_HTTPS: {{ .Values.config.forceHttps | quote }}
  CORS_ALLOWED_ORIGINS: {{ .Values.config.corsAllowedOrigins | quote }}
  DEFAULT_AUTH_MODE: {{ .Values.config.defaultAuthMode | quote }}
  COOKIE_SAME_SITE: {{ .Values.config.cookieSameSite | quote }}
  TRUST_PROXY: {{ .Values.config.trustProxy | quote }}
  {{- if .Values.config.trustProxyCidrs }}
  TRUST_PROXY_CIDRS: {{ .Values.config.trustProxyCidrs | quote }}
  {{- end }}
  {{- if .Values.config.metricsAllowCidrs }}
  METRICS_ALLOW_CIDRS: {{ .Values.config.metricsAllowCidrs | quote }}
  {{- end }}
  # JWT settings
  ACCESS_TOKEN_TTL: {{ .Values.config.jwt.accessTokenTtl | quote }}
  REFRESH_TOKEN_TTL: {{ .Values.config.jwt.refreshTokenTtl | quote }}
  MAGIC_LINK_TTL: {{ .Values.config.jwt.magicLinkTtl | quote }}
  # Email settings
  EMAIL_PROVIDER: {{ .Values.config.email.provider | quote }}
  {{- if eq .Values.config.email.provider "smtp" }}
  SMTP_HOST: {{ .Values.config.email.smtp.host | quote }}
  SMTP_PORT: {{ .Values.config.email.smtp.port | quote }}
  SMTP_USERNAME: {{ .Values.config.email.smtp.username | quote }}
  SMTP_FROM: {{ .Values.config.email.smtp.from | quote }}
  {{- end }}
  {{- if eq .Values.config.email.provider "brevo" }}
  BREVO_SENDER: {{ .Values.config.email.brevo.sender | quote }}
  {{- end }}
