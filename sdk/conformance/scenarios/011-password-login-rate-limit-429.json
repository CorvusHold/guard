{
  "name": "Password login rate limit (429)",
  "setup": {
    "env": { "TENANT_ID": "{{NONMFA2_TENANT_ID}}", "EMAIL": "{{NONMFA2_EMAIL}}", "PASSWORD": "{{NONMFA2_PASSWORD}}" }
  },
  "steps": [
    {
      "request": {
        "method": "POST",
        "path": "/v1/auth/password/login",
        "headers": { "content-type": "application/json" },
        "query": { "tenant_id": "rl-{{TENANT_ID}}" },
        "body": {
          "tenant_id": "{{TENANT_ID}}",
          "email": "{{EMAIL}}",
          "password": "{{PASSWORD}}"
        }
      },
      "expect": { "status": 200 }
    },
    {
      "request": {
        "method": "POST",
        "path": "/v1/auth/password/login",
        "headers": { "content-type": "application/json" },
        "query": { "tenant_id": "rl-{{TENANT_ID}}" },
        "body": {
          "tenant_id": "{{TENANT_ID}}",
          "email": "{{EMAIL}}",
          "password": "{{PASSWORD}}"
        }
      },
      "expect": { "status": 200 }
    },
    {
      "request": {
        "method": "POST",
        "path": "/v1/auth/password/login",
        "headers": { "content-type": "application/json" },
        "query": { "tenant_id": "rl-{{TENANT_ID}}" },
        "body": {
          "tenant_id": "{{TENANT_ID}}",
          "email": "{{EMAIL}}",
          "password": "{{PASSWORD}}"
        }
      },
      "expect": { "status": 429, "bodyContains": { "error": {} } }
    }
  ]
}
