{
  "name": "Refresh after logout should fail (401)",
  "setup": {
    "waitMs": 500,
    "env": { "TENANT_ID": "{{NONMFA_TENANT_ID}}", "EMAIL": "{{NONMFA_EMAIL}}", "PASSWORD": "{{NONMFA_PASSWORD}}" }
  },
  "requiresEnv": ["TENANT_ID", "EMAIL", "PASSWORD"],
  "steps": [
    {
      "request": {
        "method": "POST",
        "path": "/v1/auth/password/login",
        "headers": { "content-type": "application/json" },
        "query": { "tenant_id": "rl-{{TENANT_ID}}" },
        "body": {
          "tenant_id": "{{TENANT_ID}}",
          "email": "{{EMAIL}}",
          "password": "{{PASSWORD}}"
        }
      },
      "expect": { "status": 200 },
      "store": { "REFRESH_TOKEN": "refresh_token" }
    },
    {
      "request": {
        "method": "POST",
        "path": "/v1/auth/logout",
        "headers": { "content-type": "application/json" },
        "query": { "tenant_id": "rl-{{TENANT_ID}}" },
        "body": { "refresh_token": "{{REFRESH_TOKEN}}" }
      },
      "expect": { "status": 204 }
    },
    {
      "request": {
        "method": "POST",
        "path": "/v1/auth/refresh",
        "headers": { "content-type": "application/json" },
        "query": { "tenant_id": "rl-{{TENANT_ID}}" },
        "body": { "refresh_token": "{{REFRESH_TOKEN}}" }
      },
      "expect": { "status": 401 }
    }
  ]
}
