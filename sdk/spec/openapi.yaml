basePath: /
definitions:
  controller.EmailDiscoveryRequest:
    properties:
      email:
        type: string
    required:
    - email
    type: object
  controller.EmailDiscoveryResponse:
    properties:
      found:
        type: boolean
      has_tenant:
        type: boolean
      suggestions:
        items:
          type: string
        type: array
      tenant_id:
        type: string
      tenant_name:
        type: string
      user_exists:
        type: boolean
    type: object
  controller.adminUpdateNamesReq:
    properties:
      first_name:
        type: string
      last_name:
        type: string
    type: object
  controller.adminUpdateRolesReq:
    properties:
      roles:
        items:
          type: string
        type: array
    required:
    - roles
    type: object
  controller.adminUser:
    properties:
      created_at:
        type: string
      email_verified:
        type: boolean
      first_name:
        type: string
      id:
        type: string
      is_active:
        type: boolean
      last_login_at:
        type: string
      last_name:
        type: string
      roles:
        items:
          type: string
        type: array
      updated_at:
        type: string
    type: object
  controller.adminUsersResp:
    properties:
      users:
        items:
          $ref: '#/definitions/controller.adminUser'
        type: array
    type: object
  controller.createTenantReq:
    properties:
      name:
        type: string
    required:
    - name
    type: object
  controller.fgaAuthorizeReq:
    properties:
      object_id:
        type: string
      object_type:
        minLength: 1
        type: string
      permission_key:
        minLength: 1
        type: string
      subject_id:
        description: |-
          SubjectID is optional when subject_type=self; otherwise required.
          When subject_type=self, the server derives the subject from the caller's token.
        type: string
      subject_type:
        enum:
        - self
        - user
        - group
        type: string
      tenant_id:
        type: string
    required:
    - object_type
    - permission_key
    - subject_type
    - tenant_id
    type: object
  controller.fgaAuthorizeResp:
    properties:
      allowed:
        type: boolean
      reason:
        type: string
    type: object
  controller.fgaCreateACLTupleReq:
    properties:
      object_id:
        type: string
      object_type:
        minLength: 1
        type: string
      permission_key:
        minLength: 1
        type: string
      subject_id:
        type: string
      subject_type:
        enum:
        - user
        - group
        type: string
      tenant_id:
        type: string
    required:
    - object_type
    - permission_key
    - subject_id
    - subject_type
    - tenant_id
    type: object
  controller.fgaCreateGroupReq:
    properties:
      description:
        type: string
      name:
        minLength: 1
        type: string
      tenant_id:
        type: string
    required:
    - name
    - tenant_id
    type: object
  controller.fgaDeleteACLTupleReq:
    properties:
      object_id:
        type: string
      object_type:
        minLength: 1
        type: string
      permission_key:
        minLength: 1
        type: string
      subject_id:
        type: string
      subject_type:
        enum:
        - user
        - group
        type: string
      tenant_id:
        type: string
    required:
    - object_type
    - permission_key
    - subject_id
    - subject_type
    - tenant_id
    type: object
  controller.fgaGroupItem:
    properties:
      description:
        type: string
      id:
        type: string
      name:
        type: string
      tenant_id:
        type: string
    type: object
  controller.fgaListGroupsResp:
    properties:
      groups:
        items:
          $ref: '#/definitions/controller.fgaGroupItem'
        type: array
    type: object
  controller.fgaModifyGroupMemberReq:
    properties:
      user_id:
        type: string
    required:
    - user_id
    type: object
  controller.introspectReq:
    properties:
      token:
        type: string
    type: object
  controller.listResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/controller.tenantResp'
        type: array
      page:
        type: integer
      page_size:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  controller.loginReq:
    properties:
      email:
        type: string
      password:
        type: string
      tenant_id:
        type: string
    required:
    - email
    - password
    - tenant_id
    type: object
  controller.magicSendReq:
    properties:
      email:
        type: string
      redirect_url:
        type: string
      tenant_id:
        type: string
    required:
    - email
    - tenant_id
    type: object
  controller.magicVerifyReq:
    properties:
      token:
        type: string
    required:
    - token
    type: object
  controller.mfaBackupConsumeReq:
    properties:
      code:
        type: string
    required:
    - code
    type: object
  controller.mfaBackupConsumeResp:
    properties:
      consumed:
        type: boolean
    type: object
  controller.mfaBackupCountResp:
    properties:
      count:
        type: integer
    type: object
  controller.mfaBackupGenerateReq:
    properties:
      count:
        maximum: 20
        minimum: 1
        type: integer
    type: object
  controller.mfaBackupGenerateResp:
    properties:
      codes:
        items:
          type: string
        type: array
    type: object
  controller.mfaChallengeResp:
    properties:
      challenge_token:
        type: string
      methods:
        items:
          type: string
        type: array
    type: object
  controller.mfaTOTPActivateReq:
    properties:
      code:
        type: string
    required:
    - code
    type: object
  controller.mfaTOTPStartResp:
    properties:
      otpauth_url:
        type: string
      secret:
        type: string
    type: object
  controller.mfaVerifyReq:
    properties:
      challenge_token:
        type: string
      code:
        type: string
      method:
        enum:
        - totp
        - backup_code
        type: string
    required:
    - challenge_token
    - code
    - method
    type: object
  controller.oauth2MetadataResp:
    properties:
      grant_types_supported:
        items:
          type: string
        type: array
      guard_auth_mode_default:
        type: string
      guard_auth_modes_supported:
        description: Guard-specific extensions
        items:
          type: string
        type: array
      guard_version:
        type: string
      introspection_endpoint:
        type: string
      introspection_endpoint_auth_methods_supported:
        items:
          type: string
        type: array
      issuer:
        type: string
      response_types_supported:
        items:
          type: string
        type: array
      revocation_endpoint:
        type: string
      revocation_endpoint_auth_methods_supported:
        items:
          type: string
        type: array
      scopes_supported:
        items:
          type: string
        type: array
      token_endpoint:
        type: string
      token_endpoint_auth_methods_supported:
        items:
          type: string
        type: array
      userinfo_endpoint:
        type: string
    type: object
  controller.permissionGrantItem:
    properties:
      key:
        type: string
      object_id:
        type: string
      object_type:
        type: string
    type: object
  controller.putSettingsRequest:
    properties:
      app_cors_allowed_origins:
        description: App
        type: string
      sso_provider:
        type: string
      sso_redirect_allowlist:
        type: string
      sso_state_ttl:
        type: string
      workos_api_key:
        type: string
      workos_client_id:
        type: string
      workos_client_secret:
        type: string
      workos_default_connection_id:
        type: string
      workos_default_organization_id:
        type: string
    type: object
  controller.rbacCreateRoleReq:
    properties:
      description:
        type: string
      name:
        type: string
      tenant_id:
        type: string
    required:
    - name
    - tenant_id
    type: object
  controller.rbacModifyUserRoleReq:
    properties:
      role_id:
        type: string
      tenant_id:
        type: string
    required:
    - role_id
    - tenant_id
    type: object
  controller.rbacPermissionItem:
    properties:
      created_at:
        type: string
      description:
        type: string
      id:
        type: string
      key:
        type: string
      updated_at:
        type: string
    type: object
  controller.rbacPermissionsResp:
    properties:
      permissions:
        items:
          $ref: '#/definitions/controller.rbacPermissionItem'
        type: array
    type: object
  controller.rbacResolvedPermissionsResp:
    properties:
      grants:
        items:
          $ref: '#/definitions/controller.permissionGrantItem'
        type: array
    type: object
  controller.rbacRoleItem:
    properties:
      created_at:
        type: string
      description:
        type: string
      id:
        type: string
      name:
        type: string
      tenant_id:
        type: string
      updated_at:
        type: string
    type: object
  controller.rbacRolePermissionReq:
    properties:
      permission_key:
        type: string
      resource_id:
        type: string
      resource_type:
        type: string
      scope_type:
        type: string
    required:
    - permission_key
    - scope_type
    type: object
  controller.rbacRolesResp:
    properties:
      roles:
        items:
          $ref: '#/definitions/controller.rbacRoleItem'
        type: array
    type: object
  controller.rbacUpdateRoleReq:
    properties:
      description:
        type: string
      name:
        type: string
      tenant_id:
        type: string
    required:
    - name
    - tenant_id
    type: object
  controller.rbacUserRolesResp:
    properties:
      role_ids:
        items:
          type: string
        type: array
    type: object
  controller.refreshReq:
    properties:
      refresh_token:
        type: string
    required:
    - refresh_token
    type: object
  controller.resetPasswordConfirmReq:
    properties:
      new_password:
        minLength: 8
        type: string
      tenant_id:
        type: string
      token:
        type: string
    required:
    - new_password
    - tenant_id
    - token
    type: object
  controller.resetPasswordRequestReq:
    properties:
      email:
        type: string
      tenant_id:
        type: string
    required:
    - email
    - tenant_id
    type: object
  controller.revokeReq:
    properties:
      token:
        type: string
      token_type:
        type: string
    required:
    - token
    - token_type
    type: object
  controller.sessionItem:
    properties:
      created_at:
        type: string
      expires_at:
        type: string
      id:
        type: string
      ip:
        type: string
      revoked:
        type: boolean
      user_agent:
        type: string
    type: object
  controller.sessionsListResp:
    properties:
      sessions:
        items:
          $ref: '#/definitions/controller.sessionItem'
        type: array
    type: object
  controller.settingsResponse:
    properties:
      app_cors_allowed_origins:
        description: App
        type: string
      sso_provider:
        description: SSO
        type: string
      sso_redirect_allowlist:
        type: string
      sso_state_ttl:
        type: string
      workos_api_key:
        description: masked
        type: string
      workos_client_id:
        type: string
      workos_client_secret:
        description: masked
        type: string
      workos_default_connection_id:
        type: string
      workos_default_organization_id:
        type: string
    type: object
  controller.signupReq:
    properties:
      email:
        type: string
      first_name:
        type: string
      last_name:
        type: string
      password:
        minLength: 8
        type: string
      tenant_id:
        type: string
    required:
    - email
    - password
    - tenant_id
    type: object
  controller.tenantResp:
    properties:
      created_at:
        type: string
      id:
        type: string
      is_active:
        type: boolean
      name:
        type: string
      updated_at:
        type: string
    type: object
  controller.tokensResp:
    properties:
      access_token:
        type: string
      refresh_token:
        type: string
    type: object
  domain.Introspection:
    properties:
      active:
        type: boolean
      email:
        type: string
      email_verified:
        type: boolean
      exp:
        type: integer
      iat:
        type: integer
      mfa_verified:
        type: boolean
      roles:
        items:
          type: string
        type: array
      tenant_id:
        type: string
      user_id:
        type: string
    type: object
  domain.PortalLink:
    properties:
      link:
        type: string
    type: object
  domain.UserProfile:
    properties:
      email:
        type: string
      email_verified:
        type: boolean
      first_name:
        type: string
      id:
        type: string
      last_login_at:
        type: string
      last_name:
        type: string
      mfa_enabled:
        type: boolean
      roles:
        items:
          type: string
        type: array
      tenant_id:
        type: string
    type: object
info:
  contact: {}
  description: Central Authentication Service for multi-tenant identity management.
  title: Guard CAS API
  version: "1.0"
paths:
  /.well-known/oauth-authorization-server:
    get:
      description: RFC 8414 compliant discovery endpoint that returns server metadata
        including supported authentication modes
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.oauth2MetadataResp'
      summary: OAuth 2.0 Authorization Server Metadata
      tags:
      - auth
  /tenants:
    get:
      description: Lists tenants with optional filters and pagination
      parameters:
      - description: Search query
        in: query
        name: q
        type: string
      - description: -1 any, 1 active, 0 inactive
        in: query
        name: active
        type: integer
      - description: Page number
        in: query
        name: page
        type: integer
      - description: Page size
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.listResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: List tenants
      tags:
      - tenants
    post:
      consumes:
      - application/json
      description: Creates a new tenant
      parameters:
      - description: name
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.createTenantReq'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/controller.tenantResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Create tenant
      tags:
      - tenants
  /tenants/{id}:
    get:
      description: Fetch a tenant by UUID
      parameters:
      - description: Tenant ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.tenantResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get tenant by ID
      tags:
      - tenants
  /tenants/{id}/deactivate:
    patch:
      description: Deactivates a tenant by ID
      parameters:
      - description: Tenant ID (UUID)
        in: path
        name: id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Deactivate tenant
      tags:
      - tenants
  /tenants/by-name/{name}:
    get:
      description: Fetch a tenant by unique name
      parameters:
      - description: Tenant name
        in: path
        name: name
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.tenantResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get tenant by name
      tags:
      - tenants
  /v1/auth/admin/fga/acl/tuples:
    delete:
      consumes:
      - application/json
      description: Deletes a direct permission grant (tuple).
      parameters:
      - description: tuple selector
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.fgaDeleteACLTupleReq'
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Delete ACL tuple (admin-only)
      tags:
      - auth.admin
    post:
      consumes:
      - application/json
      description: Creates a direct permission grant (tuple).
      parameters:
      - description: tuple payload
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.fgaCreateACLTupleReq'
      responses:
        "201":
          description: Created
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Create ACL tuple (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/fga/groups:
    get:
      description: Lists groups for the specified tenant.
      parameters:
      - description: Tenant ID (UUID)
        in: query
        name: tenant_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.fgaListGroupsResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List groups for a tenant (admin-only)
      tags:
      - auth.admin
    post:
      consumes:
      - application/json
      description: Creates a new group for the specified tenant.
      parameters:
      - description: tenant_id, name, description
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.fgaCreateGroupReq'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/controller.fgaGroupItem'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Conflict
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Create group (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/fga/groups/{id}:
    delete:
      description: Deletes a group for the specified tenant.
      parameters:
      - description: Group ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Tenant ID (UUID)
        in: query
        name: tenant_id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Delete group (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/fga/groups/{id}/members:
    delete:
      consumes:
      - application/json
      description: Removes a user from a group.
      parameters:
      - description: Group ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: user_id
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.fgaModifyGroupMemberReq'
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Remove user from group (admin-only)
      tags:
      - auth.admin
    post:
      consumes:
      - application/json
      description: Adds a user to a group.
      parameters:
      - description: Group ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: user_id
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.fgaModifyGroupMemberReq'
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Add user to group (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/rbac/permissions:
    get:
      description: Returns all known permissions.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.rbacPermissionsResp'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List all permissions (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/rbac/roles:
    get:
      description: Returns all roles for the specified tenant.
      parameters:
      - description: Tenant ID (UUID)
        in: query
        name: tenant_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.rbacRolesResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List roles for a tenant (admin-only)
      tags:
      - auth.admin
    post:
      consumes:
      - application/json
      description: Creates a new role for the specified tenant.
      parameters:
      - description: tenant_id, name, optional description
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.rbacCreateRoleReq'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/controller.rbacRoleItem'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Create role (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/rbac/roles/{id}:
    delete:
      description: Deletes a role for the specified tenant.
      parameters:
      - description: Role ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Tenant ID (UUID)
        in: query
        name: tenant_id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Delete role (admin-only)
      tags:
      - auth.admin
    patch:
      consumes:
      - application/json
      description: Updates a role's name/description in the specified tenant.
      parameters:
      - description: Role ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: tenant_id, name, optional description
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.rbacUpdateRoleReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.rbacRoleItem'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update role (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/rbac/roles/{id}/permissions:
    delete:
      consumes:
      - application/json
      description: Deletes a permission grant for a role, optionally scoped to a resource.
      parameters:
      - description: Role ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: permission_key, scope_type, optional resource_type/resource_id
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.rbacRolePermissionReq'
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Delete a permission grant from a role (admin-only)
      tags:
      - auth.admin
    post:
      consumes:
      - application/json
      description: Upserts a permission grant for a role, optionally scoped to a resource.
      parameters:
      - description: Role ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: permission_key, scope_type, optional resource_type/resource_id
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.rbacRolePermissionReq'
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Grant/Update a permission to a role (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/rbac/users/{id}/permissions/resolve:
    get:
      description: Aggregates user permissions from roles and ACL for a tenant.
      parameters:
      - description: User ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Tenant ID (UUID)
        in: query
        name: tenant_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.rbacResolvedPermissionsResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Resolve user permissions (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/rbac/users/{id}/roles:
    delete:
      consumes:
      - application/json
      description: Removes a role assignment for a user within a tenant.
      parameters:
      - description: User ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: tenant_id, role_id
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.rbacModifyUserRoleReq'
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Remove a role from a user (admin-only)
      tags:
      - auth.admin
    get:
      description: Lists role assignments for a user within a tenant.
      parameters:
      - description: User ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Tenant ID (UUID)
        in: query
        name: tenant_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.rbacUserRolesResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List role IDs assigned to a user (admin-only)
      tags:
      - auth.admin
    post:
      consumes:
      - application/json
      description: Adds a role assignment for a user within a tenant.
      parameters:
      - description: User ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: tenant_id, role_id
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.rbacModifyUserRoleReq'
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Add a role to a user (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/users:
    get:
      description: Lists all users that belong to the specified tenant. Requires caller
        to have the admin role.
      parameters:
      - description: Tenant ID (UUID)
        in: query
        name: tenant_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.adminUsersResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List users for a tenant (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/users/{id}:
    patch:
      consumes:
      - application/json
      description: Updates first and/or last name for a user. Requires caller to have
        the admin role.
      parameters:
      - description: User ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: first_name, last_name
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.adminUpdateNamesReq'
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update a user's names (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/users/{id}/block:
    post:
      description: Sets a user's active status to false. Requires caller to have the
        admin role.
      parameters:
      - description: User ID (UUID)
        in: path
        name: id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Block a user (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/users/{id}/roles:
    post:
      consumes:
      - application/json
      description: Updates the roles array for a user. Requires caller to have the
        admin role.
      parameters:
      - description: User ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: roles
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.adminUpdateRolesReq'
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update a user's roles (admin-only)
      tags:
      - auth.admin
  /v1/auth/admin/users/{id}/unblock:
    post:
      description: Sets a user's active status to true. Requires caller to have the
        admin role.
      parameters:
      - description: User ID (UUID)
        in: path
        name: id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Unblock a user (admin-only)
      tags:
      - auth.admin
  /v1/auth/authorize:
    post:
      consumes:
      - application/json
      description: 'Returns allow/deny for a subject, action (permission_key) and
        object. Note: subject_id is optional when subject_type=self (it will be derived
        from the caller token).'
      parameters:
      - description: decision input (subject_id optional when subject_type=self)
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.fgaAuthorizeReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.fgaAuthorizeResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Authorization decision
      tags:
      - auth
  /v1/auth/email/discover:
    post:
      consumes:
      - application/json
      description: Check if an email exists in any tenant and provide guidance
      parameters:
      - description: Email to discover
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controller.EmailDiscoveryRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.EmailDiscoveryResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Discover user/tenant by email
      tags:
      - auth
  /v1/auth/introspect:
    post:
      consumes:
      - application/json
      description: Validate and parse JWT token either from Authorization header or
        request body
      parameters:
      - description: Token in body; otherwise uses Authorization Bearer
        in: body
        name: token
        schema:
          $ref: '#/definitions/controller.introspectReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Introspection'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Introspect access token
      tags:
      - auth.introspect
  /v1/auth/logout:
    post:
      consumes:
      - application/json
      description: Revokes the provided refresh token if present; idempotent
      parameters:
      - description: refresh_token (optional)
        in: body
        name: body
        schema:
          $ref: '#/definitions/controller.refreshReq'
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Logout (revoke refresh token)
      tags:
      - auth.tokens
  /v1/auth/magic/send:
    post:
      consumes:
      - application/json
      description: Sends a single-use magic login link to the user's email
      parameters:
      - description: tenant_id, email, optional redirect_url
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.magicSendReq'
      responses:
        "202":
          description: Accepted
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Send magic login link
      tags:
      - auth.magic
  /v1/auth/magic/verify:
    get:
      consumes:
      - application/json
      description: Verifies magic link token from query parameter or request body
        and returns tokens
      parameters:
      - description: Magic token (alternative to body)
        in: query
        name: token
        type: string
      - description: Magic token in JSON body
        in: body
        name: body
        schema:
          $ref: '#/definitions/controller.magicVerifyReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.tokensResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Verify magic link token
      tags:
      - auth.magic
    post:
      consumes:
      - application/json
      description: Verifies magic link token from query parameter or request body
        and returns tokens
      parameters:
      - description: Magic token (alternative to body)
        in: query
        name: token
        type: string
      - description: Magic token in JSON body
        in: body
        name: body
        schema:
          $ref: '#/definitions/controller.magicVerifyReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.tokensResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Verify magic link token
      tags:
      - auth.magic
  /v1/auth/me:
    get:
      description: Returns the authenticated user's profile derived from the access
        token
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.UserProfile'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get current user's profile
      tags:
      - auth.profile
  /v1/auth/mfa/backup/consume:
    post:
      consumes:
      - application/json
      description: Consumes a single-use backup code
      parameters:
      - description: backup code
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.mfaBackupConsumeReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.mfaBackupConsumeResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Consume an MFA backup code
      tags:
      - auth.mfa.backup
  /v1/auth/mfa/backup/count:
    get:
      description: Returns number of unused backup codes
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.mfaBackupCountResp'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Count remaining MFA backup codes
      tags:
      - auth.mfa.backup
  /v1/auth/mfa/backup/generate:
    post:
      consumes:
      - application/json
      description: Generates backup codes, stores their hashes, and returns the codes
      parameters:
      - description: count (default 10, max 20)
        in: body
        name: body
        schema:
          $ref: '#/definitions/controller.mfaBackupGenerateReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.mfaBackupGenerateResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Generate MFA backup codes
      tags:
      - auth.mfa.backup
  /v1/auth/mfa/totp/activate:
    post:
      consumes:
      - application/json
      description: Verifies a TOTP code for the stored secret and enables MFA
      parameters:
      - description: TOTP code
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.mfaTOTPActivateReq'
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Activate TOTP
      tags:
      - auth.mfa.totp
  /v1/auth/mfa/totp/disable:
    post:
      description: Disables TOTP for the user
      responses:
        "204":
          description: No Content
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Disable TOTP
      tags:
      - auth.mfa.totp
  /v1/auth/mfa/totp/start:
    post:
      description: Generates and stores a TOTP secret (disabled) and returns the secret
        and otpauth URL
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.mfaTOTPStartResp'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Start TOTP enrollment
      tags:
      - auth.mfa.totp
  /v1/auth/mfa/verify:
    post:
      consumes:
      - application/json
      description: Verifies a TOTP or backup code against a challenge token and returns
        access/refresh tokens.
      parameters:
      - description: challenge_token, method, and code
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.mfaVerifyReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.tokensResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Verify MFA challenge
      tags:
      - auth.mfa
  /v1/auth/password/login:
    post:
      consumes:
      - application/json
      description: Logs in with email/password. If MFA is enabled for the user, responds
        202 with a challenge to complete via /v1/auth/mfa/verify.
      parameters:
      - description: email/password
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.loginReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.tokensResp'
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/controller.mfaChallengeResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Password login
      tags:
      - auth.password
  /v1/auth/password/reset/confirm:
    post:
      consumes:
      - application/json
      description: Resets the password for the given email address
      parameters:
      - description: tenant_id, token, new_password
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.resetPasswordConfirmReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Confirm password reset
      tags:
      - auth.password
  /v1/auth/password/reset/request:
    post:
      consumes:
      - application/json
      description: Requests a password reset for the given email address
      parameters:
      - description: tenant_id, email
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.resetPasswordRequestReq'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Request password reset
      tags:
      - auth.password
  /v1/auth/password/signup:
    post:
      consumes:
      - application/json
      description: Creates a new user for a tenant with email and password and returns
        access/refresh tokens
      parameters:
      - description: tenant_id, email, password, optional first/last name
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.signupReq'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/controller.tokensResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Password signup
      tags:
      - auth.password
  /v1/auth/refresh:
    post:
      consumes:
      - application/json
      description: 'Exchanges a refresh token for new access and refresh tokens. When
        using cookie mode (`X-Auth-Mode: cookie`), the server will read `guard_refresh_token`
        from cookies if the body omits `refresh_token` and returns `{"success":true}`
        while setting new cookies.'
      parameters:
      - description: refresh_token
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.refreshReq'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.tokensResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Refresh access token
      tags:
      - auth.tokens
  /v1/auth/revoke:
    post:
      consumes:
      - application/json
      description: Revoke a token; currently supports token_type="refresh"
      parameters:
      - description: token and token_type=refresh
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.revokeReq'
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Revoke token
      tags:
      - auth.tokens
  /v1/auth/sessions:
    get:
      description: Lists the authenticated user's sessions (refresh tokens) for the
        current tenant.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.sessionsListResp'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List my active sessions
      tags:
      - auth.sessions
  /v1/auth/sessions/{id}/revoke:
    post:
      description: Revokes a specific session by ID for the authenticated user within
        the current tenant.
      parameters:
      - description: Session ID (UUID)
        in: path
        name: id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Revoke a specific session
      tags:
      - auth.sessions
  /v1/auth/sso/{provider}/callback:
    get:
      description: Completes SSO flow and returns access/refresh tokens
      parameters:
      - description: SSO provider (google, github, azuread)
        in: path
        name: provider
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.tokensResp'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Handle SSO/OAuth callback
      tags:
      - auth.sso
  /v1/auth/sso/{provider}/portal-link:
    get:
      description: Generates a link to the organization portal for the given provider
        and organization ID (admin-only)
      parameters:
      - description: SSO provider (workos)
        in: path
        name: provider
        required: true
        type: string
      - description: Organization identifier
        in: query
        name: organization_id
        required: true
        type: string
      - description: Tenant ID (UUID)
        in: query
        name: tenant_id
        required: true
        type: string
      - description: Intent (sso, dsync, audit_logs, log_streams, domain_verification,
          certificate_renewal, user_management)
        in: query
        name: intent
        type: string
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.PortalLink'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Generate organization portal link
      tags:
      - auth.sso
  /v1/auth/sso/{provider}/start:
    get:
      description: Initiates an SSO flow for the given provider and redirects to the
        provider authorization URL
      parameters:
      - description: SSO provider (google, github, azuread, workos)
        in: path
        name: provider
        required: true
        type: string
      - description: Tenant ID (UUID)
        in: query
        name: tenant_id
        required: true
        type: string
      - description: Absolute redirect URL after callback
        in: query
        name: redirect_url
        type: string
      - description: Opaque state to round-trip
        in: query
        name: state
        type: string
      - description: Provider connection identifier
        in: query
        name: connection_id
        type: string
      - description: Organization identifier
        in: query
        name: organization_id
        type: string
      responses:
        "302":
          description: Found
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Start SSO/OAuth flow
      tags:
      - auth.sso
  /v1/tenants/{id}/settings:
    get:
      description: Returns tenant-scoped settings required for SSO setup (WorkOS)
      parameters:
      - description: Tenant ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controller.settingsResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get tenant settings (subset)
      tags:
      - tenants
    put:
      consumes:
      - application/json
      description: Upserts tenant settings for SSO setup (WorkOS). Only whitelisted
        keys are accepted.
      parameters:
      - description: Tenant ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: settings
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/controller.putSettingsRequest'
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "429":
          description: Too Many Requests
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Upsert tenant settings (subset)
      tags:
      - tenants
schemes:
- http
securityDefinitions:
  BearerAuth:
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
